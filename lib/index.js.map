{"version":3,"sources":["../src/index.js"],"names":["TextRemark","options","container","text","remarks","links","console","error","$container","document","querySelector","classList","add","activeRemark","startSelect","$showText","createElement","className","$realText","innerText","addEvents","appendChild","updateShowText","type","curSection","getRange","baseOffset","extentOffset","push","mixinEvent","addEventListener","e","$target","target","contains","index","getAttribute","tagType","dispatchEvent","remark","remove","mySelection","filter","item","section","canAdd","i","length","obj","baseArr","concat","curHtml","renderHashText","innerHTML","__events","events","on","cb","off","undefined","curEvent","splice","once","listener","args","apply","self","option","forEach","call","getHashText","textMap","Object","create","splitNums","sort","a","b","prevIndex","oriText","curIndex","substring","window","getSelection","max","Math","min","tagName","attrs","$dom","key","textHashMap","resHtml","remarkIndex","curObj"],"mappings":"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","sourcesContent":["export default class TextRemark {\n  constructor(options) {\n    const { container, text = '', remarks = [], links = [] } = options\n    if (!container || !text) {\n      console.error('TextRemark need a container and text')\n      return\n    }\n    if (typeof container === 'string') {\n      this.$container = document.querySelector(container)\n    } else {\n      this.$container = container\n    }\n    this.$container.classList.add('text-remark')\n    this.text = text\n    this.remarks = remarks\n    this.links = links\n    this.activeRemark = null\n    this.startSelect = false\n    //显示\n    this.$showText = createElement('div', { className: 'text-remark-content' })\n    this.$realText = createElement('div', { className: 'text-remark-content real-text' })\n    this.$realText.innerText = text\n    this.addEvents()\n    this.$container.appendChild(this.$realText)\n    this.$container.appendChild(this.$showText)\n\n    this.updateShowText()\n  }\n  addRemark(type) {\n    // 获取当前的active\n    if (this.activeRemark) {\n      let curSection = getRange(type, this.activeRemark)\n      if (curSection.baseOffset !== curSection.extentOffset) {\n        this.remarks.push({ type, baseOffset: curSection.baseOffset, extentOffset: curSection.extentOffset })\n        this.activeRemark = null\n        this.updateShowText()\n      }\n    }\n  }\n  addEvents() {\n    mixinEvent(this)\n    this.$container.addEventListener(\n      'mousedown',\n      e => {\n        this.$container.classList.add('mousedown')\n        this.startSelect = true\n        let $target = e.target\n        if ($target && $target.classList.contains('text-remark-tag')) {\n          let index = $target.getAttribute('data-index')\n          let tagType = $target.getAttribute('data-type')\n          this.dispatchEvent('tag-selected', { target: e.target, tagType, remark: { ...this.remarks[index] } })\n        }\n      },\n      false\n    )\n    this.$container.addEventListener(\n      'mouseup',\n      e => {\n        this.$container.classList.remove('mousedown')\n        this.startSelect = false\n        this.mySelection(e)\n      },\n      false\n    )\n    this.$realText.addEventListener(\n      'mousemove',\n      e => {\n        if (this.startSelect) {\n          this.mySelection(e)\n        }\n      },\n      false\n    )\n  }\n  getJson() {\n    return {\n      remarks: this.remarks.filter(item => item.type !== 'active')\n    }\n  }\n  clearActive() {\n    this.activeRemark = null\n    this.updateShowText()\n  }\n  mySelection() {\n    let section = getRange('active')\n    let canAdd = true\n    for (let i = 0; i < this.remarks.length; i++) {\n      let obj = this.remarks[i]\n      if (section.baseOffset >= obj.baseOffset && section.baseOffset <= obj.extentOffset) {\n        canAdd = false\n        break\n      } else if (section.extentOffset >= obj.baseOffset && section.extentOffset <= obj.extentOffset) {\n        canAdd = false\n        break\n      }\n    }\n    if (canAdd && section.baseOffset !== section.extentOffset) {\n      this.activeRemark = getRange('active')\n      this.updateShowText()\n    }\n  }\n  updateShowText() {\n    // 合并默认标记数据和已有的标记数据\n    let baseArr = this.activeRemark ? [this.activeRemark] : []\n    let remarks = baseArr.concat(this.remarks)\n    let curHtml = renderHashText(this.text, remarks)\n    this.$showText.innerHTML = curHtml\n  }\n}\n// 其它方法\n// 事件属性处理\nfunction mixinEvent(target) {\n  target.__events = target.__events || []\n  let events = target.__events\n  target.on = function (type, cb) {\n    events.push({ type, cb })\n    return target\n  }\n  target.off = function (type, cb) {\n    for (let i = 0; i < events.length; i++) {\n      if (cb === undefined) {\n        events = []\n      } else {\n        let curEvent = events[i]\n        if (curEvent.type === type && curEvent.cb === cb) {\n          events.splice(i, 1)\n          i--\n        }\n      }\n    }\n    return target\n  }\n  target.once = function (type, cb) {\n    const listener = function (...args) {\n      cb.apply(target, args)\n      self.off(type, cb)\n    }\n    return target.on(type, listener)\n  }\n  target.dispatchEvent = function (type, option) {\n    events.forEach(item => {\n      if (item.type === type) {\n        item.cb.call(target, { type, ...option })\n      }\n    })\n    return target\n  }\n}\n// 其它通用方法\nfunction getHashText(text, remarks) {\n  let textMap = Object.create(null)\n  if (remarks.length > 0) {\n    let splitNums = []\n    remarks.forEach(obj => {\n      splitNums.push(obj.baseOffset)\n      splitNums.push(obj.extentOffset)\n    })\n    splitNums.sort((a, b) => a - b)\n    let prevIndex = 0\n    let oriText = text\n    for (let i = 0; i < splitNums.length; i++) {\n      let curIndex = splitNums[i]\n      textMap[curIndex] = oriText.substring(prevIndex, curIndex)\n      prevIndex = curIndex\n    }\n    // 剩余的文本\n    if (prevIndex < oriText.length - 1) {\n      textMap[oriText.length - 1] = oriText.substring(prevIndex)\n    }\n  }\n  return textMap\n}\nfunction getRange(type, section) {\n  // 输出baseOffset < extentOffset\n  // 如果有参数section 采用参数，如果没有，获取当前页面\n  let curSection = section || window.getSelection()\n  let { baseOffset, extentOffset } = curSection\n  let max = Math.max(baseOffset, extentOffset)\n  let min = Math.min(baseOffset, extentOffset)\n  return {\n    baseOffset: min,\n    extentOffset: max,\n    type\n  }\n}\nfunction createElement(tagName, attrs = {}) {\n  // 创建元素\n  const $dom = document.createElement(tagName)\n  for (let key in attrs) {\n    $dom[key] = attrs[key]\n  }\n  return $dom\n}\n\nfunction renderHashText(text, remarks) {\n  let textHashMap = getHashText(text, remarks)\n  if (remarks.length === 0) {\n    return text\n  } else {\n    let resHtml = ''\n    let remarkIndex = 0\n    for (let i = 0; i < remarks.length; i++) {\n      let curObj = remarks[i]\n      if (textHashMap[curObj.baseOffset]) {\n        if (curObj.type === 'active') {\n          textHashMap[curObj.baseOffset] += '<span data-type=\"' + curObj.type + '\" class=\"text-remark-tag text-remark-' + curObj.type + '\">'\n        } else {\n          textHashMap[curObj.baseOffset] += '<span data-type=\"' + curObj.type + '\" data-index=\"' + remarkIndex + '\" class=\"text-remark-tag text-remark-' + curObj.type + '\">'\n        }\n      }\n      if (textHashMap[curObj.extentOffset]) {\n        textHashMap[curObj.extentOffset] += '</span>'\n      }\n      if (curObj.type !== 'active') {\n        remarkIndex++\n      }\n    }\n    for (let key in textHashMap) {\n      resHtml += textHashMap[key]\n    }\n    return resHtml\n  }\n}\n"],"file":"index.js"}